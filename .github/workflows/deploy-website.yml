name: Deploy Website to S3

on:
  push:
    branches: [ main, Zaid-DevOps ]
    paths:
      - '**/*.html'
      - '**/*.css'
      - '**/*.js'
      - '**/*.jpeg'
      - '**/*.png'
      - '**/*.jpg'
      - 'images/**'

jobs:
  deploy-website:
    runs-on: ubuntu-latest
    permissions:
      id-token: write
      contents: read
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
    
    - name: Configure AWS credentials
      uses: aws-actions/configure-aws-credentials@v3
      with:
        role-to-assume: ${{ secrets.AWS_ROLE }}
        aws-region: ${{ secrets.AWS_REGION }}
    
    - name: Upload website files to S3
      run: |
        # Sync all HTML, CSS, JS, images to S3
        aws s3 sync ./ s3://YOUR-BUCKET-NAME --delete \
          --exclude ".git/*" \
          --exclude ".github/*" \
          --exclude "*.tf" \
          --exclude ".gitignore" \
          --exclude "README.md" \
          --exclude "dockerFile"